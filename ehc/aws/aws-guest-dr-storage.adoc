---
sidebar: sidebar 
permalink: ehc/aws/aws-guest-dr-storage.html 
keywords: on premises, on prem, cloud storage, Amazon FSx, Network interface, vm datastore 
summary: NetApp AFF 之所以能提供高效能儲存基礎架構、是因為它具備靈活的資料管理選項、能夠滿足各式各樣的企業情境。在本解決方案中、ONTAP AFF 我們使用了一個功能完善的內部部署儲存系統。 
---
= 儲存設備
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./../../media/


link:aws-guest-dr-networking.html["上一篇：網路。"]

NetApp AFF 之所以能提供高效能儲存基礎架構、是因為它具備靈活的資料管理選項、能夠滿足各式各樣的企業情境。在本解決方案中、ONTAP AFF 我們使用了一個功能完善的內部部署儲存系統。

解決方案中使用NetApp ONTAP 功能搭配ONTAP VMware及SnapCenter VMware的支援功能、提供與VMware vSphere緊密整合的全方位管理與應用程式備份功能。



== 內部部署

我們使用ONTAP VMware資料存放區來存放虛擬機器及其VMDK檔案。VMware支援連接資料存放區的多種儲存傳輸協定、在此解決方案中、我們使用NFS磁碟區來存放ESXi主機上的資料存放區。不過ONTAP 、支援VMware支援的所有傳輸協定均由支援。

下圖說明VMware儲存選項。

image:dr-vmc-aws-image7.png["錯誤：缺少圖形影像"]

將支援iSCSI和NFS的來賓連線儲存設備用於我們的應用程式VM。ONTAP我們使用下列儲存傳輸協定來處理應用程式資料：

* NFS磁碟區、用於連接客體的Oracle資料庫檔案。
* iSCSI LUN、用於連接來賓的Microsoft SQL Server資料庫和交易記錄。


|===
| 作業系統 | 資料庫類型 | 儲存傳輸協定 | Volume說明 


| Windows Server 2019 | 2019年SQL Server | iSCSI | 資料庫檔案 


|  |  | iSCSI | 記錄檔 


| Oracle Linux 8.5 | Oracle 19c | NFS | Oracle二進位 


|  |  | NFS | Oracle資料 


|  |  | NFS | Oracle恢復檔案 
|===
我們也使用ONTAP 支援主要Veeam備份儲存庫的功能、以及SnapCenter 用於還原資料庫備份的備份目標。

* Veeam備份儲存庫的SMB共用區。
* SMB共享區是SnapCenter 進行資料庫還原備份的目標。




== 雲端儲存設備

此解決方案包含AWS上的VMware Cloud、可用來裝載還原為容錯移轉程序一部分的虛擬機器。截至本文撰寫時、VMware支援裝載VM和VMDK之資料存放區的vSAN儲存設備。

FSX for ONTAP Sfor Sfor Sfor FSfor是應用程式資料的二線儲存設備、這些應用程式資料是使用SnapCenter 鏡射和SyncMirror 鏡射的。作為容錯移轉程序的一部分、FSXfor ONTAP Sfor the cluster會轉換為主要儲存設備、資料庫應用程式可恢復在FSX儲存 叢集上執行的正常功能。



=== Amazon FSX for NetApp ONTAP 的功能

若要使用ONTAP Cloud Manager部署AWS FSX for NetApp解決方案、請依照中的指示操作 https://docs.netapp.com/us-en/cloud-manager-fsx-ontap/start/task-getting-started-fsx.html["此連結"^]。

部署完FSX ONTAP 功能後、將內部部署ONTAP 的動作例項拖放到FSX ONTAP 支援區中、即可開始建立磁碟區的複寫設定。

下圖說明我們的FSX ONTAP 支援環境。

image:dr-vmc-aws-image8.png["錯誤：缺少圖形影像"]



=== 已建立網路介面

FSX for NetApp ONTAP Suse已預先設定網路介面、可用於iSCSI、NFS、SMB及叢集間網路。



=== VM資料存放區儲存

VMware Cloud SDDC隨附兩個VSAN資料存放區、分別名為「vsandatastore」和「workloaddatastore」。我們使用「vsandatastore」來裝載管理虛擬機器、其存取限制為cloudadmin認證。對於工作負載、我們使用「workloaddatastore」。

link:aws-guest-dr-compute.html["下一步：運算。"]
