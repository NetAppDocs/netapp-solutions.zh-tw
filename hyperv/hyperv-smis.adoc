---
sidebar: sidebar 
permalink: hyperv/hyperv-smis.html 
keywords: hyperv, hyper-v, SMI-S, SCVMM, netapp, virtualization 
summary: 本白皮書說明如何安裝及管理 NetApp SMI-S Provider ，以及如何使用 Microsoft SCVMM 配置儲存設備。 
---
= 適用於 Microsoft Hyper-V 的 NetApp SMI-S Provider
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ../media/


[role="lead"]
本文介紹如何安裝和管理NetApp SMI-S Provider，以及如何使用 Microsoft System Center Virtual Machine Manager (SCVMM) 設定儲存。



== 簡介

NetApp 儲存管理計畫規格（ SMI-S ）是管理與監控儲存系統的強大工具。NetApp SMI-S 利用網路型企業管理（ WBEM ）傳輸協定，為各種管理工作提供統一的介面，包括 LUN ，磁碟區， CIMOM 組態設定和 CIM 伺服器使用者的處理。

SCVMM 是虛擬化資料中心的全面管理解決方案。 SCVMM能夠透過儲存管理計畫規格 (SMI-S) 與各種儲存系統整合。



=== NetApp SMI-S Provider與 SCVMM 結合使用的優勢

將NetApp SMI-S Provider與 SCVMM 相集成，可為儲存管理提供標準化接口，從而使組織能夠在虛擬化資料中心中更有效地管理儲存資源。

* 儲存系統偵測與管理：偵測執行 ONTAP 軟體的儲存系統，並提供有效管理的工具。
* 簡化管理：提供單一命令型介面，簡化儲存系統的管理。
* 監控與報告：提供強大的監控與報告功能，可追蹤儲存元件及其效能。


如需詳細資料，請參閱link:https://docs.netapp.com/us-en/smis-provider["NetApp SMI-S Provider 產品文件。"]

image:hyperv-smis-image1.png["採用 Hyper-V 架構的 NetApp SMI-S"]



== 準備好進行 SMI-S Provider 部署

與現有儲存系統的無縫整合需要正確安裝和配置NetApp SMI-S Provider。

* NetApp SMI-S Provider 5.2.7 支援 Windows Server SCVMM 2025、2022、2019 和 2016 以及 Windows Server 2025、2022、2019 和 2016。此版本與Windows Server 2012或System Center Virtual Machine Manager（SCVMM）2012不相容。
* NetApp SMI-S Provider 5.2.7 沒有可用的升級路徑。您必須將NetApp SMI-S Provider 5.2.7 部署為全新安裝。
* NetApp SMI-S 供應商支援 ONTAP 9 及更新版本的 FAS 和 AFF 系統。
* NetApp ONTAP One 授權涵蓋 SMI-S 供應商的所有授權需求。如果沒有此許可證，您需要以下許可證：
+
** 在儲存系統上建立LUN時、需要FCP、iSCSI或兩者的FCP和iSCSI授權。
** 在支援ONTAP 的功能區儲存系統上建立檔案共用時、需要CIFS授權。
** 需要FlexClone授權、才能在執行支援ONTAP 的版本的叢集式儲存系統上建立LUN複製。






=== SMI-S 虛擬機器硬體需求

下表顯示了NetApp SMI-S 供應商 VM 硬體需求。

image:hyperv-smis-image2.png["SMI-S 供應商硬體需求"]



=== 安裝 SMI-S Provider

在開始 SMI-S 提供者部署之前，您需要部署具有 SCVMM 的 Microsoft Hyper-V 和NetApp 9 以上FAS或AFF儲存系統。請務必瞭解命令型介面，以便執行各種管理工作，請檢查link:https://docs.netapp.com/us-en/smis-provider/concept-smi-s-provider-commands-overview.html["NetApp SMI-S Provider 命令。"]

[]
====
最佳實務： NetApp建議使用專用的 Windows Server 來安裝NetApp SMI-S Provider，不要安裝在 SCVMM 伺服器上，以防止幹擾、最佳化效能並簡化故障排除。

====
. 在支援 SMI-S 的 Windows 伺服器虛擬機器中，從下載NetApp SMI-S Provider版本 5.2.7 link:https://mysupport.netapp.com/site/global/dashboard["NetApp軟體下載網站"]並將檔案儲存為 smisprovider-5-2-7.msi。
. 導覽至包含NetApp SMI-S Provider軟體套件的目錄並雙擊套件 smisprovider-5-2-7.msi，依照安裝精靈中的步驟完成安裝。
. 在「開始」功能表中，導覽至NetApp SMI-S Provider，右鍵並選擇「以管理員身分執行」。當命令列提示符開啟時，執行命令「smis cimserver status」以驗證NetApp SMI-S Provider是否正在執行。 image:hyperv-smis-image3.png["確認 SMI-S 伺服器正在執行"]
. 新增一個 CIM 伺服器用戶，此 SMI-S 用戶應在 Windows SMI-S 伺服器中擁有管理員權限，並且您需要使用此用戶向 SCVMM 註冊。此 SMI-S 使用者可以是本機使用者或網域使用者。 image:hyperv-smis-image13.png["新增 CIM 用戶"]
. 若要新增NetApp儲存系統，您可以使用儲存虛擬機器 (SVM) 的管理 IP 位址或 DNS 可解析主機名，以及 vsadmin 使用者的憑證。 image:hyperv-smis-image4.png["註冊 SVM"]




=== 使用 SCVMM 連線 SMI-S Provider

要在 SCVMM 中新增遠端儲存裝置並連接到 SMI-S 提供程序，您需要確保滿足以下先決條件和步驟：

* 網路存取：確保 SCVMM 伺服器可以透過其 IP 位址或完全限定網域名稱 (FQDN) 透過網路存取 SMI-S 提供者。
* 通訊連接埠：驗證 SCVMM 和 SMI-S 提供者是否可以使用適當的連接埠透過網路進行通訊：
+
** 連接埠 5989 上的 HTTPS
** 連接埠 5988 上的 HTTP




[]
====
在安裝 SMI-S 提供者時放置了過期的憑證。因此，在 System Center Virtual Machine Manager (SCVMM) 中，透過「新增儲存設備」連接到 SMI-S 提供者的 SSL 連線失敗。解決方案是link:https://kb.netapp.com/data-mgmt/SMI-S/SMI-S_Issues/CSMIS-3["為 CIM 伺服器產生自簽名證書"]然後重新啟動 SMI-S 服務。更多信息，請參閱知識庫文章link:https://kb.netapp.com/data-mgmt/SMI-S/SMI-S_Issues/CSMIS-3["CSMIS-3： NetApp SMI-S Provider 5.2.7 中的 cimom.cert 在安裝時已過期。"]

====
. 在 SCVMM 中，按一下「Fabric」>「Storage」>「Providers」>「Add Storage Devices」。選擇「由 SMI-S 提供者發現和管理的 SAN 和 NAS 設備」。 image:hyperv-smis-image5.png["新增儲存裝置"]
. 在指定發現範圍中，選擇 SMI-S CIMXML 作為協議，輸入安裝 SMI-S 代理程式的伺服器的 IP 位址或 FQDN，如果需要，選擇 SSL 連線選項，並輸入在 SMI-S 伺服器上建立的 SMI-S 帳戶。 image:hyperv-smis-image6.png["安裝 SMI-S Agent"]
. 在「收集資訊」中，SCVMM 會自動發現並匯入儲存設備資訊。如果上一步選擇了 SSL 連接，則需要匯入安全性憑證。 image:hyperv-smis-image15.png["導入證書"]
. 選擇儲存設備、分類和主機群組，查看摘要並按完成。 image:hyperv-smis-image7.png["選擇分類"]
. 若要查看 SMI-S 連接，請按一下 Fabric > Overview，檢查儲存摘要、分類使用情況、每個陣列的邏輯單元和主機群組儲存。 image:hyperv-smis-image11.png["檢查 SVM 容量"]




=== 使用 SMI-S 提供者透過 SCVMM 設定存儲

SCVMM 使用 SMI-S Provider 與儲存系統互動，讓您直接從 SCVMM 建立及管理儲存資源。



==== iSCSI儲存設備

. 在 SCVMM 控制台中，選擇 Fabric > Storage，右鍵點選 Classifications and Pools，然後選擇 Create Logical Unit。選擇儲存池和分類，然後輸入邏輯單元的名稱，說明，大小和主機群組。image:hyperv-smis-image9.png["建立邏輯單元儲存設備"]




==== SMB 儲存設備

. 選擇 Fabric > Storage > 右鍵點選 File Servers 並選擇 Create File Share，選擇 File server，輸入名稱、儲存類型、儲存池和分類。 image:hyperv-smis-image10.png["建立檔案共用"]
. 要將 SMB 檔案共用用於 Hyper-V，您需要將 SMB 檔案共用新增至 Hyper-V 主機叢集。在 SCVMM 中，按一下「伺服器」>「所有主機」>「[主機群組]」。右鍵單擊群集名稱並選擇“屬性”。在「檔案共用儲存」標籤中，按一下「新增」並輸入 SMB 路徑。 image:hyperv-smis-image14.png["將 SMB 檔案共用新增至 Hyper-V 主機叢集"]




== 記錄與追蹤資料

您可以設定 SMI-S Provider 如何管理記錄和追蹤檔案，例如指定要記錄的訊息層級，以及要儲存記錄的目錄。您也可以指定要追蹤的元件、要寫入追蹤訊息的目標、追蹤層級、以及追蹤檔案位置。



==== 記錄設定

根據預設，系統會記錄所有系統訊息，系統訊息記錄會位於安裝 NetApp SMI-S Provider 的目錄中的 logs 目錄中。您可以變更寫入 CIM 伺服器記錄檔的系統訊息位置和層級。

* 您可以從「追蹤」，「資訊」，「警告」，「嚴重」，「致命」中選擇記錄層級。若要變更系統訊息記錄層級，請使用下列命令：


[]
====
cimconfig -s logLevel=new_log_level -p

====
* 變更系統訊息記錄目錄


[]
====
cimconfig -s logdir=new_log_directory -p

====


==== 追蹤設定

image:hyperv-smis-image12.png["追蹤設定"]



== 結論

NetApp SMI-S Provider 是儲存管理員不可或缺的工具，提供標準化，有效率且全方位的儲存系統管理與監控解決方案。透過運用業界標準的通訊協定和架構，可確保相容性，並簡化與儲存網路管理相關的複雜性。
